# 🧑‍💻 Exercise – Create an Azure Virtual Machine (VM) and Install Nginx

We’ll use the **Azure CLI in Cloud Shell**.

---

## 📝 Task 1: Create a Resource Group

Resource groups are containers for related resources.

1. 🔑 Log into the [Azure portal](https://portal.azure.com).
2. 🖥 Select the **Cloud Shell** icon (top bar).

   * Choose **Bash** if prompted.
3. Run the command:

```bash
az group create --name IntroAzureRG --location eastus
```

✅ Creates a resource group called **IntroAzureRG** in the **East US** region.

---

## 📝 Task 2: Create a Linux Virtual Machine

Now, create a VM named **my-vm** running Ubuntu 22.04.

Run:

```bash
az vm create \
  --resource-group "IntroAzureRG" \
  --name my-vm \
  --size Standard_D2s_v5 \
  --public-ip-sku Standard \
  --image Ubuntu2204 \
  --admin-username azureuser \
  --generate-ssh-keys
```

### What this does:

* 📦 Puts VM inside **IntroAzureRG**
* 🖥 Creates a VM named **my-vm**
* ⚙ Uses **Ubuntu 22.04 image**
* 👤 Sets username = `azureuser`
* 🔑 Generates SSH keys for secure login
* 🌐 Allocates a **Standard public IP**

⏳ It takes a few moments → VM is provisioned and ready.

---

## 📝 Task 3: Install Nginx with Custom Script Extension

We’ll install **Nginx** using the **Custom Script Extension**.

Run:

```bash
az vm extension set \
  --resource-group "IntroAzureRG" \
  --vm-name my-vm \
  --name customScript \
  --publisher Microsoft.Azure.Extensions \
  --version 2.1 \
  --settings '{"fileUris":["https://raw.githubusercontent.com/MicrosoftDocs/mslearn-welcome-to-azure/master/configure-nginx.sh"]}' \
  --protected-settings '{"commandToExecute": "./configure-nginx.sh"}'
```

### What happens:

1. 📥 Script is downloaded from GitHub → `configure-nginx.sh`
2. 🔄 Updates package list → `apt-get update`
3. 📦 Installs **Nginx web server**
4. 🏠 Updates `/var/www/html/index.html` to show a **welcome message** with VM hostname

---

## 🎉 Verification

* Copy your VM’s **public IP address** (shown in output of `az vm create`).
* Open browser → `http://<public-ip>`
* You should see:
  👉 A **Welcome page from Nginx**, with your VM’s hostname.

---

## 🧹 Clean Up (After Module Completion)

To avoid extra charges, delete the entire resource group:

```bash
az group delete --name IntroAzureRG --yes --no-wait
```

This removes the **VM + all related resources** in one step.

---

# ✅ Summary

* Created **IntroAzureRG** resource group
* Provisioned **Ubuntu Linux VM (my-vm)**
* Installed **Nginx web server** with Custom Script Extension
* Verified with VM’s public IP
