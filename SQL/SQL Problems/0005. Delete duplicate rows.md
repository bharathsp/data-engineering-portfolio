You are given a table with the following structure and sample data:

#### **Table: `employee_table`**

| employee\_name | department | salary |
| -------------- | ---------- | ------ |
| James          | Sales      | 3000   |
| Michael        | Sales      | 4600   |
| Robert         | Sales      | 4600   |
| Maria          | Finance    | 3000   |
| Scott          | Finance    | 3300   |
| Jen            | Finance    | 3900   |
| Jeff           | Marketing  | 3000   |
| Kumar          | Marketing  | 2000   |
| Saif           | Sales      | 4100   |
| Scott          | Finance    | 3300   |

---

### **Tasks:**

1. **Write an SQL query to identify duplicate records**, where a record is considered duplicate if all three columns (`employee_name`, `department`, `salary`) are the same.

2. **Write an SQL query to remove duplicate records**, ensuring that only the first occurrence of each duplicate combination is retained in the table.

---

### âœ… **1. Get Duplicate Records**

To identify duplicates, assume a record is duplicate if **all columns** (`employee_name`, `department`, `salary`) are the same.
Here's the SQL to find such rows:

```sql
SELECT employee_name, department, salary, COUNT(*) as count
FROM employee_table
GROUP BY employee_name, department, salary
HAVING COUNT(*) > 1;
```

This will return rows that appear more than once.

---

### âœ… **2. Delete Duplicate Records (Keep Only One Copy)**

There are several ways to delete duplicates, but a common method in **SQL (e.g., Spark SQL or PostgreSQL)** is using a **CTE with ROW\_NUMBER** to retain only the first occurrence.

```sql
WITH ranked_employees AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY employee_name, department, salary ORDER BY employee_name) AS rn
    FROM employee_table
)
DELETE FROM employee_table
WHERE (employee_name, department, salary) IN (
    SELECT employee_name, department, salary
    FROM ranked_employees
    WHERE rn > 1
);
```

> ğŸ”¸ This query **keeps the first occurrence** of each duplicate record and **deletes the rest**.
