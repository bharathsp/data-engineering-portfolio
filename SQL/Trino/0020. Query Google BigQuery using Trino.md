## **1Ô∏è‚É£ Pre-requisites**

* ‚úÖ Trino installed (Coordinator + Workers running)
* ‚úÖ Google Cloud Project with BigQuery dataset
* ‚úÖ Service Account with **BigQuery Data Viewer** or **BigQuery User** role
* ‚úÖ JSON key file downloaded for the service account

---

## **2Ô∏è‚É£ Setup the BigQuery Connector in Trino**

1. Go to the Trino **catalog folder**:

```bash
etc/catalog/
```

2. Create a file named `bigquery.properties`:

```properties
connector.name=bigquery
project-id=<your-gcp-project-id>
google-json-key-file=/path/to/your-service-account-key.json
```

* **connector.name** ‚Üí must be `bigquery`
* **project-id** ‚Üí your Google Cloud Project ID
* **google-json-key-file** ‚Üí path to JSON key file

3. (Optional) Advanced configs:

```properties
bigquery.views-enabled=true       # To query views
bigquery.materialized-views-enabled=true
bigquery.cache-enabled=true
```

---

## **3Ô∏è‚É£ Restart Trino**

```bash
bin/launcher restart
```

* Ensures the BigQuery connector is loaded.
* Coordinator logs should show: `Catalog 'bigquery' initialized`.

---

## **4Ô∏è‚É£ Verify the Catalog**

```sql
SHOW CATALOGS;
```

* You should see `bigquery` in the list.

```sql
SHOW SCHEMAS FROM bigquery;
```

* Lists all datasets in your GCP project.

---

## **5Ô∏è‚É£ Querying BigQuery**

### ‚úÖ Example 1: List tables in a dataset

```sql
SHOW TABLES FROM bigquery.<dataset_name>;
```

---

### ‚úÖ Example 2: Simple SELECT

```sql
SELECT name, COUNT(*) AS total_orders
FROM bigquery.sales_dataset.orders
WHERE order_date >= DATE '2025-09-01'
GROUP BY name
ORDER BY total_orders DESC
LIMIT 10;
```

---

### ‚úÖ Example 3: Join BigQuery tables

```sql
SELECT c.customer_id, c.name, SUM(o.amount) AS total_spent
FROM bigquery.sales_dataset.customers c
JOIN bigquery.sales_dataset.orders o
  ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.name
ORDER BY total_spent DESC
LIMIT 20;
```

---

### ‚úÖ Example 4: Use Trino Functions

```sql
SELECT customer_id, DATE_TRUNC('month', order_date) AS month, SUM(amount) AS monthly_sales
FROM bigquery.sales_dataset.orders
GROUP BY customer_id, DATE_TRUNC('month', order_date)
ORDER BY monthly_sales DESC
LIMIT 10;
```

---

## **6Ô∏è‚É£ Tips & Best Practices**

* üìå **Partitioned tables** in BigQuery ‚Üí Trino will push down filters to avoid scanning unnecessary partitions.
* üìå **Joins** ‚Üí Prefer broadcasting smaller tables if possible (`/*+ BROADCAST(table) */`).
* üìå **Views** ‚Üí Enable `bigquery.views-enabled=true` to query BigQuery views.
* üìå **Caching** ‚Üí `bigquery.cache-enabled=true` can improve performance for repeated queries.
