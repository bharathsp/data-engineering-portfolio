# 📌 What is a Partitioned Join in Trino?

* 🔗 A **distributed join strategy** where **both tables** are **partitioned (shuffled)** across worker nodes **based on the join key**.
* 📦 Each worker only processes the rows where the join key matches its partition.

👉 Useful when **both tables are large** and cannot be broadcast.

---

# ⚙️ How It Works in Trino

1. 🗂 **Big Table A** → Partitioned by join key across workers.
2. 🗂 **Big Table B** → Partitioned by the same join key.
3. 🖥️ Each worker → Gets only the matching partitions from both tables.
4. 🔄 Join happens locally on each worker’s partition.

---

# ✅ When to Use Partitioned Joins

* 📊 Both tables are **large** (don’t fit in memory).
* 🔑 **High-cardinality join keys** (spreads data evenly across workers).
* 🏗 **Fact-to-fact joins** in data lakes or warehouses.
* ⚖️ Good when **broadcast is not possible** due to memory constraints.

---

# 🚫 When NOT to Use

* 🛑 If one table is **small enough to broadcast** (broadcast is usually faster).
* 🐢 Expensive if **data skew** exists → one worker may get too much data.
* 🌐 More **network shuffle cost**, since both tables move across the cluster.

---

# 🖼️ Visual Comparison: Broadcast vs Partitioned Joins

| 🔍 Join Type            | ⚙️ Strategy                                                             | ✅ Best When                                                           |
| ----------------------- | ----------------------------------------------------------------------- | --------------------------------------------------------------------- |
| 📡 **Broadcast Join**   | Small table replicated to all workers; big table scanned locally        | One table is **small** (fits in memory), e.g., fact + small dimension |
| 🔄 **Partitioned Join** | Both tables **shuffled & partitioned** by join key, then joined locally | Both tables are **large**, cannot be broadcast, e.g., fact + fact     |

---

# 💡 Pro Tip

* You can **force partitioned join** in Trino using:

```sql
SELECT /*+ PARTITIONED(big_table1, big_table2) */ *
FROM big_table1 t1
JOIN big_table2 t2
   ON t1.id = t2.id;
```
