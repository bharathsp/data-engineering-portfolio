# ğŸ“Œ What is a Partitioned Join in Trino?

* ğŸ”— A **distributed join strategy** where **both tables** are **partitioned (shuffled)** across worker nodes **based on the join key**.
* ğŸ“¦ Each worker only processes the rows where the join key matches its partition.

ğŸ‘‰ Useful when **both tables are large** and cannot be broadcast.

---

# âš™ï¸ How It Works in Trino

1. ğŸ—‚ **Big Table A** â†’ Partitioned by join key across workers.
2. ğŸ—‚ **Big Table B** â†’ Partitioned by the same join key.
3. ğŸ–¥ï¸ Each worker â†’ Gets only the matching partitions from both tables.
4. ğŸ”„ Join happens locally on each workerâ€™s partition.

---

# âœ… When to Use Partitioned Joins

* ğŸ“Š Both tables are **large** (donâ€™t fit in memory).
* ğŸ”‘ **High-cardinality join keys** (spreads data evenly across workers).
* ğŸ— **Fact-to-fact joins** in data lakes or warehouses.
* âš–ï¸ Good when **broadcast is not possible** due to memory constraints.

---

# ğŸš« When NOT to Use

* ğŸ›‘ If one table is **small enough to broadcast** (broadcast is usually faster).
* ğŸ¢ Expensive if **data skew** exists â†’ one worker may get too much data.
* ğŸŒ More **network shuffle cost**, since both tables move across the cluster.

---

# ğŸ–¼ï¸ Visual Comparison: Broadcast vs Partitioned Joins

| ğŸ” Join Type            | âš™ï¸ Strategy                                                             | âœ… Best When                                                           |
| ----------------------- | ----------------------------------------------------------------------- | --------------------------------------------------------------------- |
| ğŸ“¡ **Broadcast Join**   | Small table replicated to all workers; big table scanned locally        | One table is **small** (fits in memory), e.g., fact + small dimension |
| ğŸ”„ **Partitioned Join** | Both tables **shuffled & partitioned** by join key, then joined locally | Both tables are **large**, cannot be broadcast, e.g., fact + fact     |

---

# ğŸ’¡ Pro Tip

* You can **force partitioned join** in Trino using:

```sql
SELECT /*+ PARTITIONED(big_table1, big_table2) */ *
FROM big_table1 t1
JOIN big_table2 t2
   ON t1.id = t2.id;
```
