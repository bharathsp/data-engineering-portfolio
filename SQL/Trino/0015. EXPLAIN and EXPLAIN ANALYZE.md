# 📌 1. EXPLAIN in Trino

* 🛠 **What it does**: Shows the **query execution plan** *without running the query*.
* 🖼 Helps understand how Trino will execute (e.g., join strategy, scan, aggregation).
* ✅ Good for debugging performance before actually running a heavy query.

### Example

```sql
EXPLAIN 
SELECT c.customer_id, SUM(o.amount) AS total_spent
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
GROUP BY c.customer_id;
```

👉 Output (simplified):

```
- Output[c.customer_id, sum] => [customer_id:bigint, sum:double]
    - RemoteExchange[GATHER]
        - Aggregate (sum)
            - RemoteExchange[REPARTITION]
                - Join[customer_id]
                    - Scan[Table: orders]
                    - Scan[Table: customers]
```

Here you can see:

* 📡 Remote exchange = data shuffle
* 🔗 Join type (partitioned or broadcast)
* 📊 Aggregate (SUM)

---

# 📌 2. EXPLAIN ANALYZE in Trino

* 🛠 **What it does**: Runs the query and shows the **execution plan + real runtime statistics**.
* 📊 Includes **timing, rows processed, memory usage**.
* ✅ Used for performance tuning (find bottlenecks).

### Example

```sql
EXPLAIN ANALYZE 
SELECT c.customer_id, SUM(o.amount) AS total_spent
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
GROUP BY c.customer_id;
```

👉 Output (simplified):

```
- Output[c.customer_id, sum] => [customer_id:bigint, sum:double]
    CPU: 1.52s, Input: 1.2M rows, Output: 10K rows
    - RemoteExchange[GATHER]
        CPU: 0.12s, Output: 10K rows
        - Aggregate (sum)
            CPU: 0.34s, Input: 1.2M rows
            - RemoteExchange[REPARTITION]
                CPU: 0.45s, Input: 1.2M rows
                - Join[customer_id] => [o.customer_id, c.customer_id]
                    CPU: 0.61s, Input: 1.2M + 50K rows
                    - Scan[orders]: 1.2M rows, 0.3s
                    - Scan[customers]: 50K rows, 0.05s
```

Here you can see:

* ⏱ Actual CPU time spent at each stage
* 📦 Number of rows processed
* 💾 Memory footprint

---

# 🖼️ Visual Difference

| Command                | Runs Query? | Shows Execution Plan | Runtime Stats (CPU, rows, memory) |
| ---------------------- | ----------- | -------------------- | --------------------------------- |
| 📄 **EXPLAIN**         | ❌ No        | ✅ Yes                | ❌ No                              |
| 📊 **EXPLAIN ANALYZE** | ✅ Yes       | ✅ Yes                | ✅ Yes                             |

---

# 💡 Pro Tips

* Use **EXPLAIN** before running a costly query → understand execution strategy.
* Use **EXPLAIN ANALYZE** for performance debugging → identify bottlenecks.
