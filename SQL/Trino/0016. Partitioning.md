# 📌 What is Partitioning in Trino?

* 📂 **Partitioning** = Splitting a dataset into smaller chunks based on a **partition column** (like `date`, `region`, `category`).
* 🚀 Helps Trino **skip reading unnecessary partitions** → improves query performance.
* ⚡ Especially useful when working with large datasets stored in **Hive, Iceberg, Delta Lake, Hudi** etc.

---

# ⚙️ How Partitioning Works

* Data is stored in **directories (partitions)**.
* When you filter on the partition key, Trino **only reads relevant partitions** instead of the full dataset.

👉 Example: Table `sales` partitioned by `sale_date`.

```
/sales/sale_date=2025-09-20/...
/sales/sale_date=2025-09-21/...
/sales/sale_date=2025-09-22/...
```

---

# ✅ Example 1: Create a Partitioned Table (Iceberg in Trino)

```sql
CREATE TABLE iceberg.retail.sales_partitioned (
    order_id BIGINT,
    customer_id BIGINT,
    amount DOUBLE,
    region VARCHAR,
    sale_date DATE
)
WITH (
    format = 'PARQUET',
    partitioning = ARRAY['region', 'sale_date']
);
```

👉 This table is **partitioned by `region` and `sale_date`**.

---

# ✅ Example 2: Insert Data into Partitioned Table

```sql
INSERT INTO iceberg.retail.sales_partitioned 
VALUES 
(101, 5001, 250.00, 'APAC', DATE '2025-09-20'),
(102, 5002, 100.00, 'EU', DATE '2025-09-21'),
(103, 5003, 75.50,  'APAC', DATE '2025-09-22');
```

---

# ✅ Example 3: Query with Partition Pruning

```sql
SELECT region, SUM(amount) AS total_sales
FROM iceberg.retail.sales_partitioned
WHERE sale_date = DATE '2025-09-21'
GROUP BY region;
```

👉 Trino will only scan partition `sale_date=2025-09-21` instead of the whole dataset → ⚡ much faster.

---

# ✅ Example 4: Show Partition Metadata

For Hive/Iceberg tables you can inspect partitions:

```sql
SHOW PARTITIONS FROM iceberg.retail.sales_partitioned;
```

---

# 🖼️ Visual Summary

* 📂 **Partitioning** → Organizes data into chunks.
* 🔎 **Partition pruning** → Skip irrelevant data → faster queries.
* ⚡ Works best with large **time-series** or **region-based** datasets.
