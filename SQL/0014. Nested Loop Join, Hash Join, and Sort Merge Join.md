# ðŸŒŸ 1. **Nested Loop Join (NLJ)**

ðŸ“– **What it is:**

* Simplest type of join
* For each row in **outer table**, scan all rows in **inner table** and check for matches

---

### ðŸ” How it works

Suppose we have two tables:

**Employees**

| EmpID | Name  | DeptID |
| ----- | ----- | ------ |
| 1     | Alice | 10     |
| 2     | Bob   | 20     |
| 3     | Carol | 10     |

**Departments**

| DeptID | DeptName |
| ------ | -------- |
| 10     | HR       |
| 20     | IT       |

Query:

```sql
SELECT * 
FROM Employees e
JOIN Departments d ON e.DeptID = d.DeptID;
```

**Nested Loop Join Steps:**

1. Take first employee â†’ Alice (DeptID=10)
2. Scan **Departments** table â†’ match DeptID=10 â†’ HR âœ…
3. Next employee â†’ Bob (DeptID=20) â†’ scan Departments â†’ IT âœ…
4. Repeat for all rows

```
Outer loop: Employees
Inner loop: Departments
Check each pair
```

---

### ðŸ¡ Analogy

Like **checking every student in a class against every seat in the room ðŸª‘** to find the one that matches.

---

### âœ… When to use

* Small tables
* No indexes available
* Simple and easy to implement

### âŒ Disadvantages

* Slow for large tables (O(N\*M))

---

# ðŸŒŸ 2. **Hash Join**

ðŸ“– **What it is:**

* Uses **hashing** to speed up joins
* Build a **hash table** for one table (usually smaller one) and probe the other table

---

### ðŸ” How it works

1. **Build Phase:** Hash the **small table** (Departments) on join column (DeptID)

```
Hash Table:
10 â†’ HR
20 â†’ IT
```

2. **Probe Phase:** Go through **Employees** and check hash table for DeptID match

* Alice â†’ DeptID=10 â†’ hash table â†’ HR âœ…
* Bob â†’ DeptID=20 â†’ hash table â†’ IT âœ…

---

### ðŸ¡ Analogy

Like **indexing a phonebook ðŸ“– by last name** and quickly looking up numbers instead of scanning all pages.

---

### âœ… When to use

* Large tables where one is smaller (fits in memory)
* Equality joins (`=`)

### âŒ Limitations

* Not efficient for **range joins** (`>` or `<`)

---

# ðŸŒŸ 3. **Sort Merge Join (SMJ)**

ðŸ“– **What it is:**

* Both tables are **sorted on join key**
* Merge them by scanning in order, similar to merge step in merge sort

---

### ðŸ” How it works

1. Sort **Employees** and **Departments** by DeptID

```
Employees sorted: 1-Alice-10, 3-Carol-10, 2-Bob-20
Departments sorted: 10-HR, 20-IT
```

2. Merge:

* Start pointers at beginning of both tables
* Compare join key â†’ if match, output â†’ move pointers
* Repeat until end

---

### ðŸ¡ Analogy

Like **merging two sorted lists of guests at a party ðŸŽ‰**:

* Sorted by last name
* Compare sequentially â†’ easy to match couples

---

### âœ… When to use

* Both tables are **already sorted**
* Large tables
* Range joins possible

### âŒ Limitations

* Sorting can be expensive if tables are not pre-sorted

---

# ðŸ–¼ï¸ Quick Summary Table

| Join Type            | How it Works                                   | Best Use Case                       | Notes                  |
| -------------------- | ---------------------------------------------- | ----------------------------------- | ---------------------- |
| **Nested Loop Join** | Scan inner table for each outer row            | Small tables, simple queries        | Slow for large tables  |
| **Hash Join**        | Build hash table on smaller table, probe other | Large tables, equality join         | Fast, but only for `=` |
| **Sort Merge Join**  | Sort both tables, merge sequentially           | Large tables, sorted or range joins | Sorting adds overhead  |

---

# ðŸ”‘ PostgreSQL Planner Settings

PostgreSQL lets you **turn join strategies on or off** at the session level to **test or force a specific join method**.

* `enabled_nestloop` â†’ Nested Loop Join
* `enabled_hashjoin` â†’ Hash Join
* `enabled_mergejoin` â†’ Sort Merge Join

---

# ðŸ“ Example

```sql
-- Allow only Nested Loop Joins
SET enable_nestloop = TRUE;
SET enable_hashjoin = FALSE;
SET enable_mergejoin = FALSE;

-- Now run a query
SELECT e.EmpID, e.Name, d.DeptName
FROM Employees e
JOIN Departments d ON e.DeptID = d.DeptID;
```

âœ… Result:

* PostgreSQL **must use Nested Loop Join**, even if Hash Join or Merge Join would be faster.

---

# âš¡ Important Notes

1. **Session-level setting:**

   * This change lasts **only for the current session**.
   * Reset to defaults with:

     ```sql
     RESET enable_nestloop;
     RESET enable_hashjoin;
     RESET enable_mergejoin;
     ```

2. **Testing / debugging:**

   * Useful to **see query plans with different join types**.
   * Can help in **performance tuning**
