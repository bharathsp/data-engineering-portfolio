# 🌟 1. **Nested Loop Join (NLJ)**

📖 **What it is:**

* Simplest type of join
* For each row in **outer table**, scan all rows in **inner table** and check for matches

---

### 🔍 How it works

Suppose we have two tables:

**Employees**

| EmpID | Name  | DeptID |
| ----- | ----- | ------ |
| 1     | Alice | 10     |
| 2     | Bob   | 20     |
| 3     | Carol | 10     |

**Departments**

| DeptID | DeptName |
| ------ | -------- |
| 10     | HR       |
| 20     | IT       |

Query:

```sql
SELECT * 
FROM Employees e
JOIN Departments d ON e.DeptID = d.DeptID;
```

**Nested Loop Join Steps:**

1. Take first employee → Alice (DeptID=10)
2. Scan **Departments** table → match DeptID=10 → HR ✅
3. Next employee → Bob (DeptID=20) → scan Departments → IT ✅
4. Repeat for all rows

```
Outer loop: Employees
Inner loop: Departments
Check each pair
```

---

### 🏡 Analogy

Like **checking every student in a class against every seat in the room 🪑** to find the one that matches.

---

### ✅ When to use

* Small tables
* No indexes available
* Simple and easy to implement

### ❌ Disadvantages

* Slow for large tables (O(N\*M))

---

# 🌟 2. **Hash Join**

📖 **What it is:**

* Uses **hashing** to speed up joins
* Build a **hash table** for one table (usually smaller one) and probe the other table

---

### 🔍 How it works

1. **Build Phase:** Hash the **small table** (Departments) on join column (DeptID)

```
Hash Table:
10 → HR
20 → IT
```

2. **Probe Phase:** Go through **Employees** and check hash table for DeptID match

* Alice → DeptID=10 → hash table → HR ✅
* Bob → DeptID=20 → hash table → IT ✅

---

### 🏡 Analogy

Like **indexing a phonebook 📖 by last name** and quickly looking up numbers instead of scanning all pages.

---

### ✅ When to use

* Large tables where one is smaller (fits in memory)
* Equality joins (`=`)

### ❌ Limitations

* Not efficient for **range joins** (`>` or `<`)

---

# 🌟 3. **Sort Merge Join (SMJ)**

📖 **What it is:**

* Both tables are **sorted on join key**
* Merge them by scanning in order, similar to merge step in merge sort

---

### 🔍 How it works

1. Sort **Employees** and **Departments** by DeptID

```
Employees sorted: 1-Alice-10, 3-Carol-10, 2-Bob-20
Departments sorted: 10-HR, 20-IT
```

2. Merge:

* Start pointers at beginning of both tables
* Compare join key → if match, output → move pointers
* Repeat until end

---

### 🏡 Analogy

Like **merging two sorted lists of guests at a party 🎉**:

* Sorted by last name
* Compare sequentially → easy to match couples

---

### ✅ When to use

* Both tables are **already sorted**
* Large tables
* Range joins possible

### ❌ Limitations

* Sorting can be expensive if tables are not pre-sorted

---

# 🖼️ Quick Summary Table

| Join Type            | How it Works                                   | Best Use Case                       | Notes                  |
| -------------------- | ---------------------------------------------- | ----------------------------------- | ---------------------- |
| **Nested Loop Join** | Scan inner table for each outer row            | Small tables, simple queries        | Slow for large tables  |
| **Hash Join**        | Build hash table on smaller table, probe other | Large tables, equality join         | Fast, but only for `=` |
| **Sort Merge Join**  | Sort both tables, merge sequentially           | Large tables, sorted or range joins | Sorting adds overhead  |

---

# 🔑 PostgreSQL Planner Settings

PostgreSQL lets you **turn join strategies on or off** at the session level to **test or force a specific join method**.

* `enabled_nestloop` → Nested Loop Join
* `enabled_hashjoin` → Hash Join
* `enabled_mergejoin` → Sort Merge Join

---

# 📝 Example

```sql
-- Allow only Nested Loop Joins
SET enable_nestloop = TRUE;
SET enable_hashjoin = FALSE;
SET enable_mergejoin = FALSE;

-- Now run a query
SELECT e.EmpID, e.Name, d.DeptName
FROM Employees e
JOIN Departments d ON e.DeptID = d.DeptID;
```

✅ Result:

* PostgreSQL **must use Nested Loop Join**, even if Hash Join or Merge Join would be faster.

---

# ⚡ Important Notes

1. **Session-level setting:**

   * This change lasts **only for the current session**.
   * Reset to defaults with:

     ```sql
     RESET enable_nestloop;
     RESET enable_hashjoin;
     RESET enable_mergejoin;
     ```

2. **Testing / debugging:**

   * Useful to **see query plans with different join types**.
   * Can help in **performance tuning**
