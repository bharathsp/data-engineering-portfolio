# Consider a scenario where your spark job has 5 lines of code. Out of these 5 lines of code, 3 lines are narrow transformation, 1 line is wide transformation, and 1 line is action. How many jobs and stages will be created in this case?

## **Step 1: Understand the definitions**

* **Narrow Transformation** ðŸ”¹: Data from each partition is used to create data for **only one partition** in the next stage (e.g., `map`, `filter`). These do **not** cause a shuffle, so they remain in the same stage.
* **Wide Transformation** ðŸ”¹: Data from one partition may be sent to **multiple partitions** in the next stage (e.g., `groupByKey`, `reduceByKey`). These **do cause** a shuffle and therefore create a **stage boundary**.
* **Action** ðŸŽ¯: Triggers the execution of the DAG, producing **at least one job**.

---

## **Step 2: Apply it to the scenario**

You have:

1. **Line 1:** Narrow transformation
2. **Line 2:** Narrow transformation
3. **Line 3:** Narrow transformation
4. **Line 4:** Wide transformation (**shuffle**)
5. **Line 5:** Action

---

## **Step 3: Determine Jobs**

* An **action** triggers a **job**.
* You have **only 1 action**, so **only 1 job** is created.

**âœ… Number of Jobs = 1**

---

## **Step 4: Determine Stages**

* All narrow transformations before a wide transformation belong to the **same stage**.
* The wide transformation creates a **shuffle boundary**, starting a new stage.
* After the wide transformation, there may be further narrow transformations before the action â€” they remain in the same stage as the wide transformationâ€™s output stage.

**In your case:**

* **Stage 1:** Narrow â†’ Narrow â†’ Narrow (before shuffle)
* **Stage 2:** Wide transformation â†’ Action

**âœ… Number of Stages = 2**

---

### **Final Answer**

* **Jobs:** **1**
* **Stages:** **2**

---
