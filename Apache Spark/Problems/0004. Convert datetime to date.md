## Pyspark function to convert datetime to date

In **PySpark**, you can convert a **datetime** column to a **date** using the `to_date()` function from `pyspark.sql.functions`.

---

### ‚úÖ **Syntax**

```python
from pyspark.sql.functions import to_date

df = df.withColumn("date_column_only", to_date("datetime_column"))
```

---

### üß† Example

#### Sample Data

```python
from pyspark.sql import SparkSession
from pyspark.sql.functions import to_date

spark = SparkSession.builder.appName("DatetimeToDate").getOrCreate()

data = [("2023-07-12 15:30:00",), ("2023-11-05 08:00:00",)]
df = spark.createDataFrame(data, ["datetime_column"])

df.show(truncate=False)
```

#### Convert to Date

```python
df_with_date = df.withColumn("only_date", to_date("datetime_column"))

df_with_date.show(truncate=False)
```

---

### üìå Output

```
+-------------------+-----------+
|datetime_column    |only_date |
+-------------------+-----------+
|2023-07-12 15:30:00|2023-07-12|
|2023-11-05 08:00:00|2023-11-05|
+-------------------+-----------+
```

---

### ‚úÖ **Using `date_format()` to Extract Date**

The `date_format()` function formats a timestamp or date column using a specified pattern.

---

### üß† Example

```python
from pyspark.sql import SparkSession
from pyspark.sql.functions import date_format

spark = SparkSession.builder.appName("DateFormatExample").getOrCreate()

# Sample data
data = [("2023-07-12 15:30:00",), ("2023-11-05 08:00:00",)]
df = spark.createDataFrame(data, ["datetime_column"])

# Format datetime to just 'yyyy-MM-dd' using date_format
df_formatted = df.withColumn("only_date", date_format("datetime_column", "yyyy-MM-dd"))

df_formatted.show(truncate=False)
```

---

### üìå Output

```
+-------------------+-----------+
|datetime_column    |only_date |
+-------------------+-----------+
|2023-07-12 15:30:00|2023-07-12|
|2023-11-05 08:00:00|2023-11-05|
+-------------------+-----------+
```

---

### üîç When to Use `date_format()` vs `to_date()`

| Function        | Output Type | Use Case                                      |
| --------------- | ----------- | --------------------------------------------- |
| `to_date()`     | DateType    | When you want a **Date** column               |
| `date_format()` | StringType  | When you want a **String** with custom format |

---
